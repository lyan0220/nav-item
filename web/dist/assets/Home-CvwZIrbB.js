var ge=Object.defineProperty;var oe=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var ae=(g,r,o)=>r in g?ge(g,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):g[r]=o,Q=(g,r)=>{for(var o in r||(r={}))pe.call(r,o)&&ae(g,o,r[o]);if(oe)for(var o of oe(r))me.call(r,o)&&ae(g,o,r[o]);return g};var A=(g,r,o)=>new Promise((m,d)=>{var p=b=>{try{k(o.next(b))}catch(M){d(M)}},C=b=>{try{k(o.throw(b))}catch(M){d(M)}},k=b=>b.done?m(b.value):Promise.resolve(b.value).then(p,C);k((o=o.apply(g,r)).next())});import{_ as Z,r as h,c,F as I,a as B,w as K,o as u,b as l,d as W,t as T,n as U,e as X,f as re,g as Y,h as ce,i as be,j as ye,k as se,l as _e,v as ke,m as we,p as ie}from"./index-B0C-oH4H.js";import{g as Me,a as Ce,b as Se,c as xe,d as $e,e as Ie}from"./api-CPdfUet4.js";const Be=["onMouseenter","onMouseleave"],ze=["onClick"],Re=["onClick"],Te={__name:"MenuBar",props:{menus:Array,activeId:Number,activeSubMenuId:Number},emits:["select"],setup(g,{expose:r,emit:o}){const m=o,d=h(null);function p(f){d.value=f}function C(f){setTimeout(()=>{d.value===f&&(d.value=null)},100)}function k(f){const _=f.subMenus&&f.subMenus.length>0;m("select",f),_&&p(f.id)}function b(f,_){m("select",f,_),d.value=null}function M(){d.value=null}return r({closeAllSubMenus:M}),(f,_)=>(u(),c("nav",{class:"menu-bar",onClick:_[0]||(_[0]=K(()=>{},["stop"]))},[(u(!0),c(I,null,B(g.menus,n=>(u(),c("div",{key:n.id,class:"menu-item",onMouseenter:i=>p(n.id),onMouseleave:i=>C(n.id)},[l("button",{onClick:i=>k(n),class:U({active:n.id===g.activeId})},T(n.name),11,ze),n.subMenus&&n.subMenus.length>0?(u(),c("div",{key:0,class:U(["sub-menu",{show:d.value===n.id}])},[(u(!0),c(I,null,B(n.subMenus,i=>(u(),c("button",{key:i.id,onClick:v=>b(i,n),class:U([{active:i.id===g.activeSubMenuId},"sub-menu-item"])},T(i.name),11,Re))),128))],2)):W("",!0)],40,Be))),128))]))}},Ee=Z(Te,[["__scopeId","data-v-ce975f11"]]),Le=["href","title","onClick"],Ne=["src","onError"],Fe={class:"link-text"},Ae={__name:"CardGrid",props:{cards:Array},setup(g){const r=g,o=h(""),m=h("convergeIn"),d=h(null);X(()=>{r.cards&&r.cards.length>0&&p()}),re(()=>r.cards,(n,i)=>{n&&n.length>0&&(!i||i.length===0||JSON.stringify(n)!==JSON.stringify(i))&&Y(()=>{p()})},{deep:!0,immediate:!1});function p(){d.value&&clearTimeout(d.value),o.value="",Y(()=>{m.value="convergeIn",o.value=`animate-${m.value}`,d.value=setTimeout(()=>{o.value="",d.value=null},500)})}function C(n){if(!o.value)return{};const v=window.innerWidth<=480||window.innerWidth<=768?3:window.innerWidth<=1200?4:6,E=n%v,x=Math.floor(n/v),S=Math.floor(v/2),H=Math.floor(r.cards.length/v/2),L=Math.abs(E-S),G=Math.abs(x-H);return{animationDelay:`${L*.08+G*.05}s`}}function k(n){window.open(n,"_blank")}function b(n){if(n.custom_logo_path)return"http://localhost:3000/uploads/"+n.custom_logo_path;if(n.logo_url)return n.logo_url;try{return new URL(n.url).origin+"/favicon.ico"}catch(i){return"/default-favicon.png"}}function M(n,i){n.target.src="/default-favicon.png"}function f(n){let i="";return n.desc&&(i+=n.desc+`
`),i+=n.url,i}function _(n){return n?n.length>20?n.slice(0,20)+"...":n:""}return(n,i)=>(u(),c("div",{class:U(["container card-grid",o.value])},[(u(!0),c(I,null,B(g.cards,(v,E)=>(u(),c("div",{key:v.id,class:"link-item",style:ce(C(E))},[l("a",{href:v.url,target:"_blank",title:f(v),onClick:K(x=>k(v.url),["prevent"])},[l("img",{class:"link-icon",src:b(v),alt:"",onError:x=>M(x),loading:"lazy"},null,40,Ne),l("span",Fe,T(_(v.title)),1)],8,Le)],4))),128))],2))}},We=Z(Ae,[["__scopeId","data-v-b1c5eb5e"]]),Ue={class:"menu-bar-fixed"},Ge={class:"search-section"},Oe={class:"search-box-wrapper"},qe={class:"search-engine-select"},De=["onClick"],Ve={class:"search-container"},Je=["placeholder"],Ke={key:0,class:"ad-space-fixed left-ad-fixed"},He=["href"],je=["src"],Pe={key:1,class:"ad-space-fixed right-ad-fixed"},Qe=["href"],Xe=["src"],Ye={class:"footer"},Ze={class:"modal-header"},et={class:"modal-body"},tt={class:"friend-links-grid"},nt=["href"],lt={class:"friend-link-logo"},ot=["src","alt"],at={key:1,class:"friend-link-placeholder"},st={class:"friend-link-info"},it={__name:"Home",setup(g){const r=h([]),o=h(null),m=h(null),d=h([]),p=h(""),C=h([]),k=h([]),b=h(!1),M=h([]),f=h(!1);let _=null;const n=h(null),i=new Map,v=h({bg_url_pc:"",bg_url_mobile:"",bg_opacity:"1",glass_opacity:"1",custom_css:""}),E=be(()=>{const t=v.value.bg_url_pc,e=v.value.bg_url_mobile,s=parseFloat(v.value.bg_opacity),a=1-(isNaN(s)?.15:s),w={};t&&(w["--dynamic-bg-pc"]=`url(${t})`),e&&(w["--dynamic-bg-mobile"]=`url(${e})`),t||e?w["--dynamic-overlay-color"]=`rgba(0, 0, 0, ${a})`:w["--dynamic-overlay-color"]="rgba(0, 0, 0, 0)";const D=v.value.glass_opacity,$=parseFloat(D),R=isNaN($)?.7:$;w["--glass-color-rgb"]="255, 255, 255",w["--glass-opacity"]=R;const N=Math.min(R+.15,1);return w["--glass-opacity-hover"]=N,w}),x=[{name:"google",label:"Google",placeholder:"Google 搜索...",url:t=>`https://www.google.com/search?q=${encodeURIComponent(t)}`},{name:"baidu",label:"百度",placeholder:"百度搜索...",url:t=>`https://www.baidu.com/s?wd=${encodeURIComponent(t)}`},{name:"bing",label:"Bing",placeholder:"Bing 搜索...",url:t=>`https://www.bing.com/search?q=${encodeURIComponent(t)}`},{name:"github",label:"github",placeholder:"GitHub 搜索...",url:t=>`https://github.com/search?q=${encodeURIComponent(t)}&type=repositories`},{name:"site",label:"站内",placeholder:"站内搜索...",url:t=>`/search?query=${encodeURIComponent(t)}`}],S=h(x[0]);function H(t){S.value=t}function L(){p.value="",f.value&&(f.value=!1,r.value.length?G(r.value[0]):d.value=[])}X(()=>A(null,null,function*(){Me().then(t=>{v.value=Q(Q({},v.value),t.data)}).catch(t=>{console.error("加载网站设置失败:",t)}),Ce().then(t=>{r.value=t.data,r.value.length&&(o.value=r.value[0],j())}),Se().then(t=>{C.value=t.data.filter(e=>e.position==="left"),k.value=t.data.filter(e=>e.position==="right")}),xe().then(t=>{M.value=t.data})})),re(()=>v.value.custom_css,t=>{const e="custom-nav-style";let s=document.getElementById(e);s||(s=document.createElement("style"),s.id=e,document.head.appendChild(s)),s.textContent=t||""},{immediate:!0});function G(t,e=null){return A(this,null,function*(){p.value="",f.value=!1,e?(o.value=e,m.value=t):(o.value=t,m.value=null),j()})}function j(){return A(this,null,function*(){var e;if(!o.value)return;const t=m.value?`submenu-${m.value.id}`:`menu-${o.value.id}`;if(i.has(t)){d.value=i.get(t);return}try{const s=yield $e(o.value.id,(e=m.value)==null?void 0:e.id);d.value=s.data,i.set(t,s.data)}catch(s){console.error("加载卡片失败:",s),d.value=[]}})}function ue(){clearTimeout(_),S.value.name==="site"&&(_=setTimeout(()=>{p.value.trim()===""?L():P(!0)},300))}function P(t=!1){return A(this,null,function*(){if(clearTimeout(_),S.value.name==="site"){const e=p.value.trim();if(!e){L();return}const s=`search-${e}`;if(i.has(s)){d.value=i.get(s),f.value=!0,o.value=null,m.value=null;return}try{const y=yield Ie(e);d.value=y.data,i.set(s,y.data),f.value=!0,o.value=null,m.value=null}catch(y){console.error("全局搜索失败:",y),t||alert("搜索失败，请稍后重试。")}}else{if(!p.value.trim())return;const e=S.value.url(p.value);window.open(e,"_blank")}})}function de(){n.value&&n.value.closeAllSubMenus()}function ve(t){t.target.style.display="none",t.target.nextElementSibling.style.display="flex"}const O=h(null),ee=h(null),te=h(null);let q=null;function z(){if(window.innerWidth>768)return;const t=O.value,e=ee.value,s=te.value;if(!t||!e||!s)return;e.style.fontSize="",s.style.fontSize="";const y=getComputedStyle(t),a=parseFloat(y.paddingLeft)||0,w=parseFloat(y.paddingRight)||0,D=parseFloat(y.columnGap||y.gap)||0,$=t.clientWidth-a-w;let R=e.offsetWidth,N=s.offsetWidth,F=R+D+N;if(F<=$)return;const he=parseFloat(getComputedStyle(e).fontSize)||12,fe=parseFloat(getComputedStyle(s).fontSize)||12,ne=Math.max(.5,$/F);let V=Math.max(9,Math.floor(he*ne)),J=Math.max(9,Math.floor(fe*ne));if(e.style.fontSize=V+"px",s.style.fontSize=J+"px",R=e.offsetWidth,N=s.offsetWidth,F=R+D+N,F>$){const le=Math.max(.5,$/F);V=Math.max(8,Math.floor(V*le)),J=Math.max(8,Math.floor(J*le)),e.style.fontSize=V+"px",s.style.fontSize=J+"px"}}return X(()=>{Y(()=>{z(),window.addEventListener("resize",z,{passive:!0}),window.addEventListener("orientationchange",z,{passive:!0}),window.ResizeObserver&&(q=new ResizeObserver(z),O.value&&q.observe(O.value))})}),ye(()=>{window.removeEventListener("resize",z),window.removeEventListener("orientationchange",z),q&&q.disconnect()}),(t,e)=>{var s,y;return u(),c("div",{class:"home-container",style:ce(E.value),onClick:de},[l("div",Ue,[se(Ee,{ref:n.value,menus:r.value,activeId:(s=o.value)==null?void 0:s.id,activeSubMenuId:(y=m.value)==null?void 0:y.id,onSelect:G},null,8,["menus","activeId","activeSubMenuId"])]),l("div",Ge,[l("div",Oe,[l("div",qe,[(u(),c(I,null,B(x,a=>l("button",{key:a.name,class:U(["engine-btn",{active:S.value.name===a.name}]),onClick:w=>H(a)},T(a.label),11,De)),64)),e[6]||(e[6]=l("a",{href:"/admin",target:"_blank",class:"engine-btn admin-btn"},"后台",-1))]),l("div",Ve,[_e(l("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>p.value=a),type:"text",placeholder:S.value.placeholder,class:"search-input",onKeyup:we(P,["enter"]),onInput:ue},null,40,Je),[[ke,p.value]]),p.value?(u(),c("button",{key:0,class:"clear-btn",onClick:L,"aria-label":"清空",title:"clear"},e[7]||(e[7]=[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"2"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))):W("",!0),l("button",{onClick:P,class:"search-btn",title:"search"},e[8]||(e[8]=[l("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},[l("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))])])]),C.value.length?(u(),c("div",Ke,[(u(!0),c(I,null,B(C.value,a=>(u(),c("a",{key:a.id,href:a.url,target:"_blank"},[l("img",{src:a.img,alt:"广告"},null,8,je)],8,He))),128))])):W("",!0),k.value.length?(u(),c("div",Pe,[(u(!0),c(I,null,B(k.value,a=>(u(),c("a",{key:a.id,href:a.url,target:"_blank"},[l("img",{src:a.img,alt:"广告"},null,8,Xe)],8,Qe))),128))])):W("",!0),se(We,{cards:d.value,onClick:e[1]||(e[1]=K(()=>{},["stop"]))},null,8,["cards"]),l("footer",Ye,[l("div",{class:"footer-content",ref_key:"footerContentRef",ref:O},[l("button",{onClick:e[2]||(e[2]=a=>b.value=!0),class:"friend-link-btn",ref_key:"friendBtnRef",ref:ee},e[9]||(e[9]=[l("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),l("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})],-1),ie(" 友情链接 ")]),512),l("p",{class:"copyright",ref_key:"copyrightRef",ref:te},e[10]||(e[10]=[ie("Copyright © 2025 Nav-Item | "),l("a",{href:"https://github.com/LeoJyenn/nav-item",target:"_blank",class:"footer-link"},"Powered by LeoJyenn",-1)]),512)],512)]),b.value?(u(),c("div",{key:2,class:"modal-overlay",onClick:e[5]||(e[5]=a=>b.value=!1)},[l("div",{class:"modal-content",onClick:e[4]||(e[4]=K(()=>{},["stop"]))},[l("div",Ze,[e[12]||(e[12]=l("h3",null,"友情链接",-1)),l("button",{onClick:e[3]||(e[3]=a=>b.value=!1),class:"close-btn"},e[11]||(e[11]=[l("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),l("div",et,[l("div",tt,[(u(!0),c(I,null,B(M.value,a=>(u(),c("a",{key:a.id,href:a.url,target:"_blank",class:"friend-link-card"},[l("div",lt,[a.logo?(u(),c("img",{key:0,src:a.logo,alt:a.title,onError:ve},null,40,ot)):(u(),c("div",at,T(a.title.charAt(0)),1))]),l("div",st,[l("h4",null,T(a.title),1)])],8,nt))),128))])])])])):W("",!0)],4)}}},dt=Z(it,[["__scopeId","data-v-ccc783f0"]]);export{dt as default};
