var ue=Object.defineProperty;var Y=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var Z=(h,o,l)=>o in h?ue(h,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):h[o]=l,q=(h,o)=>{for(var l in o||(o={}))de.call(o,l)&&Z(h,l,o[l]);if(Y)for(var l of Y(o))ve.call(o,l)&&Z(h,l,o[l]);return h};var B=(h,o,l)=>new Promise((m,v)=>{var f=p=>{try{y(l.next(p))}catch(C){v(C)}},_=p=>{try{y(l.throw(p))}catch(C){v(C)}},y=p=>p.done?m(p.value):Promise.resolve(p.value).then(f,_);y((l=l.apply(h,o)).next())});import{_ as W,c as r,a as n,F as S,r as T,o as c,n as J,t as L,b as d,d as le,w as D,e as N,f as H,g as V,h as ee,i as he,j as G,k as te,l as ge,v as me,m as fe,p as ne}from"./index-BkZ5uDvE.js";import{g as pe,a as _e,b as ye,c as be,d as ke,e as we}from"./api-CPdfUet4.js";const Ce={class:"menu-bar"},Me={class:"menu-list"},$e=["onClick"],xe={__name:"MenuBar",props:{menus:Array,activeId:Number},emits:["select"],setup(h,{emit:o}){const l=o;function m(v){l("select",v)}return(v,f)=>(c(),r("nav",Ce,[n("ul",Me,[(c(!0),r(S,null,T(h.menus,_=>(c(),r("li",{key:_.id,class:J(["menu-item",{active:h.activeId===_.id}]),onClick:y=>m(_)},L(_.name),11,$e))),128))])]))}},Ie=W(xe,[["__scopeId","data-v-86239783"]]),Be=["href","title","onClick"],Se=["src","onError"],Te={class:"link-text"},Ee={__name:"CardGrid",props:{cards:Array},setup(h){const o=h,l=d(""),m=d("convergeIn"),v=d(null);le(()=>{o.cards&&o.cards.length>0&&f()}),D(()=>o.cards,(a,g)=>{a&&a.length>0&&(!g||g.length===0||JSON.stringify(a)!==JSON.stringify(g))&&N(()=>{f()})},{deep:!0,immediate:!1});function f(){v.value&&clearTimeout(v.value),l.value="",N(()=>{m.value="convergeIn",l.value=`animate-${m.value}`,v.value=setTimeout(()=>{l.value="",v.value=null},500)})}function _(a){if(!l.value)return{};const u=window.innerWidth<=480||window.innerWidth<=768?3:window.innerWidth<=1200?4:6,M=a%u,b=Math.floor(a/u),k=Math.floor(u/2),U=Math.floor(o.cards.length/u/2),R=Math.abs(M-k),A=Math.abs(b-U);return{animationDelay:`${R*.08+A*.05}s`}}function y(a){window.open(a,"_blank")}function p(a){if(a.custom_logo_path)return"http://localhost:3000/uploads/"+a.custom_logo_path;if(a.logo_url)return a.logo_url;try{return new URL(a.url).origin+"/favicon.ico"}catch(g){return"/default-favicon.png"}}function C(a,g){a.target.src="/default-favicon.png"}function x(a){let g="";return a.desc&&(g+=a.desc+`
`),g+=a.url,g}function E(a){return a?a.length>20?a.slice(0,20)+"...":a:""}return(a,g)=>(c(),r("div",{class:J(["container card-grid",l.value])},[(c(!0),r(S,null,T(h.cards,(u,M)=>(c(),r("div",{key:u.id,class:"link-item",style:H(_(M))},[n("a",{href:u.url,target:"_blank",title:x(u),onClick:V(b=>y(u.url),["prevent"])},[n("img",{class:"link-icon",src:p(u),alt:"",onError:b=>C(b),loading:"lazy"},null,40,Se),n("span",Te,L(E(u.title)),1)],8,Be)],4))),128))],2))}},Le=W(Ee,[["__scopeId","data-v-b1c5eb5e"]]),Ne={class:"search-box-wrapper"},Ae={class:"search-engine-select"},Ge=["onClick"],Ue={class:"search-container"},Re=["placeholder"],ze={key:0,class:"ad-space-fixed left-ad-fixed"},Fe=["href"],Oe=["src"],qe={key:1,class:"ad-space-fixed right-ad-fixed"},De=["href"],He=["src"],Ve={class:"footer"},We={class:"footer-content"},Je={class:"modal-header"},Ke={class:"modal-body"},je={class:"friend-links-grid"},Pe=["href"],Qe={class:"friend-link-logo"},Xe=["src","alt"],Ye={key:1,class:"friend-link-placeholder"},Ze={class:"friend-link-info"},et={__name:"Home",setup(h){const o=d([]),l=d(null),m=d(null),v=d([]),f=d(""),_=d([]),y=d([]),p=d(!1),C=d([]),x=d(!1);let E=null;const a=d(null),g=d(null),u=new Map,M=d(!1),b=d(0),k=d({bg_url_pc:"",bg_url_mobile:"",bg_opacity:"1",glass_opacity:"1",custom_css:""}),U=ee(()=>{const t=k.value.bg_url_pc,e=k.value.bg_url_mobile,i=parseFloat(k.value.bg_opacity),s=1-(isNaN(i)?.15:i),w={};t&&(w["--dynamic-bg-pc"]=`url(${t})`),e&&(w["--dynamic-bg-mobile"]=`url(${e})`),t||e?w["--dynamic-overlay-color"]=`rgba(0, 0, 0, ${s})`:w["--dynamic-overlay-color"]="rgba(0, 0, 0, 0)";const re=k.value.glass_opacity,Q=parseFloat(re),X=isNaN(Q)?.7:Q;w["--glass-color-rgb"]="255, 255, 255",w["--glass-opacity"]=X;const ce=Math.min(X+.15,1);return w["--glass-opacity-hover"]=ce,w}),R=ee(()=>M.value?{marginTop:b.value>0?`${b.value+13}px`:"70px"}:{}),A=[{name:"google",label:"Google",placeholder:"Google 搜索...",url:t=>`https://www.google.com/search?q=${encodeURIComponent(t)}`},{name:"baidu",label:"百度",placeholder:"百度搜索...",url:t=>`https://www.baidu.com/s?wd=${encodeURIComponent(t)}`},{name:"bing",label:"Bing",placeholder:"Bing 搜索...",url:t=>`https://www.bing.com/search?q=${encodeURIComponent(t)}`},{name:"github",label:"github",placeholder:"GitHub 搜索...",url:t=>`https://github.com/search?q=${encodeURIComponent(t)}&type=repositories`},{name:"site",label:"站内",placeholder:"站内搜索...",url:t=>`/search?query=${encodeURIComponent(t)}`}],I=d(A[0]);function ae(t){I.value=t}function z(){f.value="",x.value&&(x.value=!1,o.value.length?j(o.value[0]):v.value=[])}function F(){if(!M.value){b.value=0;return}g.value&&(b.value=g.value.offsetHeight||0)}const K=()=>{M.value=window.innerWidth<=768,N(()=>{F()})};le(()=>B(null,null,function*(){M.value=window.innerWidth<=768,window.addEventListener("resize",K),pe().then(t=>{k.value=q(q({},k.value),t.data)}).catch(t=>{console.error("加载网站设置失败:",t)}),_e().then(t=>B(null,null,function*(){o.value=t.data,yield N(),F(),o.value.length&&(l.value=o.value[0],P())})),ye().then(t=>{_.value=t.data.filter(e=>e.position==="left"),y.value=t.data.filter(e=>e.position==="right")}),be().then(t=>{C.value=t.data})})),he(()=>{window.removeEventListener("resize",K)}),D(()=>o.value,()=>{N(()=>{F()})},{deep:!0}),D(()=>k.value.custom_css,t=>{const e="custom-nav-style";let i=document.getElementById(e);i||(i=document.createElement("style"),i.id=e,document.head.appendChild(i)),i.textContent=t||""},{immediate:!0});function j(t,e=null){return B(this,null,function*(){f.value="",x.value=!1,e?(l.value=e,m.value=t):(l.value=t,m.value=null),P()})}function P(){return B(this,null,function*(){var e;if(!l.value)return;const t=m.value?`submenu-${m.value.id}`:`menu-${l.value.id}`;if(u.has(t)){v.value=u.get(t);return}try{const i=yield ke(l.value.id,(e=m.value)==null?void 0:e.id);v.value=i.data,u.set(t,i.data)}catch(i){console.error("加载卡片失败:",i),v.value=[]}})}function oe(){clearTimeout(E),I.value.name==="site"&&(E=setTimeout(()=>{f.value.trim()===""?z():O(!0)},300))}function O(t=!1){return B(this,null,function*(){if(clearTimeout(E),I.value.name==="site"){const e=f.value.trim();if(!e){z();return}const i=`search-${e}`;if(u.has(i)){v.value=u.get(i),x.value=!0,l.value=null,m.value=null;return}try{const $=yield we(e);v.value=$.data,u.set(i,$.data),x.value=!0,l.value=null,m.value=null}catch($){console.error("全局搜索失败:",$),t||alert("搜索失败，请稍后重试。")}}else{if(!f.value.trim())return;const e=I.value.url(f.value);window.open(e,"_blank")}})}function se(){a.value&&a.value.closeAllSubMenus()}function ie(t){t.target.style.display="none",t.target.nextElementSibling.style.display="flex"}return(t,e)=>{var i,$;return c(),r("div",{class:"home-container",style:H(U.value),onClick:se},[n("div",{class:"menu-bar-fixed",ref_key:"menuBarContainer",ref:g},[te(Ie,{ref:a.value,menus:o.value,activeId:(i=l.value)==null?void 0:i.id,activeSubMenuId:($=m.value)==null?void 0:$.id,onSelect:j},null,8,["menus","activeId","activeSubMenuId"])],512),n("div",{class:"search-section",style:H(R.value)},[n("div",Ne,[n("div",Ae,[(c(),r(S,null,T(A,s=>n("button",{key:s.name,class:J(["engine-btn",{active:I.value.name===s.name}]),onClick:w=>ae(s)},L(s.label),11,Ge)),64)),e[6]||(e[6]=n("a",{href:"/admin",target:"_blank",class:"engine-btn admin-btn"}," 后台 ",-1))]),n("div",Ue,[ge(n("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>f.value=s),type:"text",placeholder:I.value.placeholder,class:"search-input",onKeyup:fe(O,["enter"]),onInput:oe},null,40,Re),[[me,f.value]]),f.value?(c(),r("button",{key:0,class:"clear-btn",onClick:z,"aria-label":"清空",title:"clear"},e[7]||(e[7]=[n("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"2"},[n("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))):G("",!0),n("button",{onClick:O,class:"search-btn",title:"search"},e[8]||(e[8]=[n("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},[n("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))])])],4),_.value.length?(c(),r("div",ze,[(c(!0),r(S,null,T(_.value,s=>(c(),r("a",{key:s.id,href:s.url,target:"_blank"},[n("img",{src:s.img,alt:"广告"},null,8,Oe)],8,Fe))),128))])):G("",!0),y.value.length?(c(),r("div",qe,[(c(!0),r(S,null,T(y.value,s=>(c(),r("a",{key:s.id,href:s.url,target:"_blank"},[n("img",{src:s.img,alt:"广告"},null,8,He)],8,De))),128))])):G("",!0),te(Le,{cards:v.value,onClick:e[1]||(e[1]=V(()=>{},["stop"]))},null,8,["cards"]),n("footer",Ve,[n("div",We,[n("button",{onClick:e[2]||(e[2]=s=>p.value=!0),class:"friend-link-btn"},e[9]||(e[9]=[n("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),n("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})],-1),ne(" 友情链接 ")])),e[10]||(e[10]=n("p",{class:"copyright"},[ne(" Copyright © 2025 Nav-Item | "),n("a",{href:"https://github.com/LeoJyenn/nav-item",target:"_blank",class:"footer-link"},"Powered by LeoJyenn")],-1))])]),p.value?(c(),r("div",{key:2,class:"modal-overlay",onClick:e[5]||(e[5]=s=>p.value=!1)},[n("div",{class:"modal-content",onClick:e[4]||(e[4]=V(()=>{},["stop"]))},[n("div",Je,[e[12]||(e[12]=n("h3",null,"友情链接",-1)),n("button",{onClick:e[3]||(e[3]=s=>p.value=!1),class:"close-btn"},e[11]||(e[11]=[n("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[n("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),n("div",Ke,[n("div",je,[(c(!0),r(S,null,T(C.value,s=>(c(),r("a",{key:s.id,href:s.url,target:"_blank",class:"friend-link-card"},[n("div",Qe,[s.logo?(c(),r("img",{key:0,src:s.logo,alt:s.title,onError:ie},null,40,Xe)):(c(),r("div",Ye,L(s.title.charAt(0)),1))]),n("div",Ze,[n("h4",null,L(s.title),1)])],8,Pe))),128))])])])])):G("",!0)],4)}}},at=W(et,[["__scopeId","data-v-7a805fe8"]]);export{at as default};
