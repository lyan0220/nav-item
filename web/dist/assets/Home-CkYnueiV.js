var he=Object.defineProperty,fe=Object.defineProperties;var ge=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var ne=(f,o,a)=>o in f?he(f,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):f[o]=a,U=(f,o)=>{for(var a in o||(o={}))me.call(o,a)&&ne(f,a,o[a]);if(te)for(var a of te(o))pe.call(o,a)&&ne(f,a,o[a]);return f},le=(f,o)=>fe(f,ge(o));var E=(f,o,a)=>new Promise((p,c)=>{var m=b=>{try{_(a.next(b))}catch(k){c(k)}},C=b=>{try{_(a.throw(b))}catch(k){c(k)}},_=b=>b.done?p(b.value):Promise.resolve(b.value).then(m,C);_((a=a.apply(f,o)).next())});import{_ as K,r as h,c as r,F as I,a as B,w as z,o as u,b as l,d as L,t as N,n as A,e as se,f as W,g as G,h as J,i as R,j as be,k as ae,l as ye,v as _e,m as ke,p as oe}from"./index-CNO7VJtj.js";import{g as we,a as Ce,b as Me,c as $e,d as xe,e as Se}from"./api-CPdfUet4.js";const Ie=["onMouseenter","onMouseleave"],Be=["onClick"],Te=["onClick"],Ee={__name:"MenuBar",props:{menus:Array,activeId:Number,activeSubMenuId:Number},emits:["select"],setup(f,{expose:o,emit:a}){const p=a,c=h(null);function m(g){c.value=g}function C(g){setTimeout(()=>{c.value===g&&(c.value=null)},100)}function _(g){const y=g.subMenus&&g.subMenus.length>0;p("select",g),y&&m(g.id)}function b(g,y){p("select",g,y),c.value=null}function k(){c.value=null}return o({closeAllSubMenus:k}),(g,y)=>(u(),r("nav",{class:"menu-bar",onClick:y[0]||(y[0]=z(()=>{},["stop"]))},[(u(!0),r(I,null,B(f.menus,n=>(u(),r("div",{key:n.id,class:"menu-item",onMouseenter:i=>m(n.id),onMouseleave:i=>C(n.id)},[l("button",{onClick:i=>_(n),class:A({active:n.id===f.activeId})},N(n.name),11,Be),n.subMenus&&n.subMenus.length>0?(u(),r("div",{key:0,class:A(["sub-menu",{show:c.value===n.id}])},[(u(!0),r(I,null,B(n.subMenus,i=>(u(),r("button",{key:i.id,onClick:d=>b(i,n),class:A([{active:i.id===f.activeSubMenuId},"sub-menu-item"])},N(i.name),11,Te))),128))],2)):L("",!0)],40,Ie))),128))]))}},Ne=K(Ee,[["__scopeId","data-v-ce975f11"]]),Le=["href","title","onClick"],Ae=["src","onError"],Ge={class:"link-text"},Ue={__name:"CardGrid",props:{cards:Array},setup(f){const o=f,a=h(""),p=h("convergeIn"),c=h(null);se(()=>{o.cards&&o.cards.length>0&&m()}),W(()=>o.cards,(n,i)=>{n&&n.length>0&&(!i||i.length===0||JSON.stringify(n)!==JSON.stringify(i))&&G(()=>{m()})},{deep:!0,immediate:!1});function m(){c.value&&clearTimeout(c.value),a.value="",G(()=>{p.value="convergeIn",a.value=`animate-${p.value}`,c.value=setTimeout(()=>{a.value="",c.value=null},500)})}function C(n){if(!a.value)return{};const d=window.innerWidth<=480||window.innerWidth<=768?3:window.innerWidth<=1200?4:6,x=n%d,M=Math.floor(n/d),w=Math.floor(d/2),F=Math.floor(o.cards.length/d/2),O=Math.abs(x-w),q=Math.abs(M-F);return{animationDelay:`${O*.08+q*.05}s`}}function _(n){window.open(n,"_blank")}function b(n){if(n.custom_logo_path)return"http://localhost:3000/uploads/"+n.custom_logo_path;if(n.logo_url)return n.logo_url;try{return new URL(n.url).origin+"/favicon.ico"}catch(i){return"/default-favicon.png"}}function k(n,i){n.target.src="/default-favicon.png"}function g(n){let i="";return n.desc&&(i+=n.desc+`
`),i+=n.url,i}function y(n){return n?n.length>20?n.slice(0,20)+"...":n:""}return(n,i)=>(u(),r("div",{class:A(["container card-grid",a.value])},[(u(!0),r(I,null,B(f.cards,(d,x)=>(u(),r("div",{key:d.id,class:"link-item",style:J(C(x))},[l("a",{href:d.url,target:"_blank",title:g(d),onClick:z(M=>_(d.url),["prevent"])},[l("img",{class:"link-icon",src:b(d),alt:"",onError:M=>k(M),loading:"lazy"},null,40,Ae),l("span",Ge,N(y(d.title)),1)],8,Le)],4))),128))],2))}},Re=K(Ue,[["__scopeId","data-v-b1c5eb5e"]]),ze={class:"search-box-wrapper"},Fe={class:"search-engine-select"},Oe=["onClick"],qe={class:"search-container"},De=["placeholder"],He={key:0,class:"ad-space-fixed left-ad-fixed"},Ve=["href"],We=["src"],Je={key:1,class:"ad-space-fixed right-ad-fixed"},Ke=["href"],je=["src"],Pe={class:"footer"},Qe={class:"footer-content"},Xe={class:"modal-header"},Ye={class:"modal-body"},Ze={class:"friend-links-grid"},et=["href"],tt={class:"friend-link-logo"},nt=["src","alt"],lt={key:1,class:"friend-link-placeholder"},at={class:"friend-link-info"},ot={__name:"Home",setup(f){const o=h([]),a=h(null),p=h(null),c=h([]),m=h(""),C=h([]),_=h([]),b=h(!1),k=h([]),g=h(!1);let y=null;const n=h(null),i=h(null),d=new Map,x=h(!1),M=h(0),w=h({bg_url_pc:"",bg_url_mobile:"",bg_opacity:"1",glass_opacity:"1",custom_css:""}),F=R(()=>{const t=w.value.bg_url_pc,e=w.value.bg_url_mobile,v=parseFloat(w.value.bg_opacity),s=1-(isNaN(v)?.15:v),$={};t&&($["--dynamic-bg-pc"]=`url(${t})`),e&&($["--dynamic-bg-mobile"]=`url(${e})`),t||e?$["--dynamic-overlay-color"]=`rgba(0, 0, 0, ${s})`:$["--dynamic-overlay-color"]="rgba(0, 0, 0, 0)";const de=w.value.glass_opacity,Z=parseFloat(de),ee=isNaN(Z)?.7:Z;$["--glass-color-rgb"]="255, 255, 255",$["--glass-opacity"]=ee;const ve=Math.min(ee+.15,1);return $["--glass-opacity-hover"]=ve,$}),O=R(()=>parseFloat(w.value.bg_opacity||"1")<=.5?"#ffffff":"#000000"),q=R(()=>le(U({},F.value),{"--global-text-color":O.value})),j=R(()=>x.value?{marginTop:M.value>0?`${M.value+13}px`:"70px"}:{}),P=[{name:"google",label:"Google",placeholder:"Google 搜索...",url:t=>`https://www.google.com/search?q=${encodeURIComponent(t)}`},{name:"baidu",label:"百度",placeholder:"百度搜索...",url:t=>`https://www.baidu.com/s?wd=${encodeURIComponent(t)}`},{name:"bing",label:"Bing",placeholder:"Bing 搜索...",url:t=>`https://www.bing.com/search?q=${encodeURIComponent(t)}`},{name:"github",label:"github",placeholder:"GitHub 搜索...",url:t=>`https://github.com/search?q=${encodeURIComponent(t)}&type=repositories`},{name:"site",label:"站内",placeholder:"站内搜索...",url:t=>`/search?query=${encodeURIComponent(t)}`}],T=h(P[0]);function ie(t){T.value=t}function D(){m.value="",g.value&&(g.value=!1,o.value.length?X(o.value[0]):c.value=[])}function H(){if(!x.value){M.value=0;return}i.value&&(M.value=i.value.offsetHeight||0)}const Q=()=>{x.value=window.innerWidth<=768,G(()=>{H()})};se(()=>E(null,null,function*(){x.value=window.innerWidth<=768,window.addEventListener("resize",Q),we().then(t=>{w.value=U(U({},w.value),t.data)}).catch(t=>{console.error("加载网站设置失败:",t)}),Ce().then(t=>E(null,null,function*(){o.value=t.data,yield G(),H(),o.value.length&&(a.value=o.value[0],Y())})),Me().then(t=>{C.value=t.data.filter(e=>e.position==="left"),_.value=t.data.filter(e=>e.position==="right")}),$e().then(t=>{k.value=t.data})})),be(()=>{window.removeEventListener("resize",Q)}),W(()=>o.value,()=>{G(()=>{H()})},{deep:!0}),W(()=>w.value.custom_css,t=>{const e="custom-nav-style";let v=document.getElementById(e);v||(v=document.createElement("style"),v.id=e,document.head.appendChild(v)),v.textContent=t||""},{immediate:!0});function X(t,e=null){return E(this,null,function*(){m.value="",g.value=!1,e?(a.value=e,p.value=t):(a.value=t,p.value=null),Y()})}function Y(){return E(this,null,function*(){var e;if(!a.value)return;const t=p.value?`submenu-${p.value.id}`:`menu-${a.value.id}`;if(d.has(t)){c.value=d.get(t);return}try{const v=yield xe(a.value.id,(e=p.value)==null?void 0:e.id);c.value=v.data,d.set(t,v.data)}catch(v){console.error("加载卡片失败:",v),c.value=[]}})}function re(){clearTimeout(y),T.value.name==="site"&&(y=setTimeout(()=>{m.value.trim()===""?D():V(!0)},300))}function V(t=!1){return E(this,null,function*(){if(clearTimeout(y),T.value.name==="site"){const e=m.value.trim();if(!e){D();return}const v=`search-${e}`;if(d.has(v)){c.value=d.get(v),g.value=!0,a.value=null,p.value=null;return}try{const S=yield Se(e);c.value=S.data,d.set(v,S.data),g.value=!0,a.value=null,p.value=null}catch(S){console.error("全局搜索失败:",S),t||alert("搜索失败，请稍后重试。")}}else{if(!m.value.trim())return;const e=T.value.url(m.value);window.open(e,"_blank")}})}function ue(){n.value&&n.value.closeAllSubMenus()}function ce(t){t.target.style.display="none",t.target.nextElementSibling.style.display="flex"}return(t,e)=>{var v,S;return u(),r("div",{class:"home-container",style:J(q.value),onClick:ue},[l("div",{class:"menu-bar-fixed",ref_key:"menuBarContainer",ref:i},[ae(Ne,{ref:n.value,menus:o.value,activeId:(v=a.value)==null?void 0:v.id,activeSubMenuId:(S=p.value)==null?void 0:S.id,onSelect:X},null,8,["menus","activeId","activeSubMenuId"])],512),l("div",{class:"search-section",style:J(j.value)},[l("div",ze,[l("div",Fe,[(u(),r(I,null,B(P,s=>l("button",{key:s.name,class:A(["engine-btn",{active:T.value.name===s.name}]),onClick:$=>ie(s)},N(s.label),11,Oe)),64)),e[6]||(e[6]=l("a",{href:"/admin",target:"_blank",class:"engine-btn admin-btn"}," 后台 ",-1))]),l("div",qe,[ye(l("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>m.value=s),type:"text",placeholder:T.value.placeholder,class:"search-input",onKeyup:ke(V,["enter"]),onInput:re},null,40,De),[[_e,m.value]]),m.value?(u(),r("button",{key:0,class:"clear-btn",onClick:D,"aria-label":"清空",title:"clear"},e[7]||(e[7]=[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"2"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))):L("",!0),l("button",{onClick:V,class:"search-btn",title:"search"},e[8]||(e[8]=[l("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},[l("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))])])],4),C.value.length?(u(),r("div",He,[(u(!0),r(I,null,B(C.value,s=>(u(),r("a",{key:s.id,href:s.url,target:"_blank"},[l("img",{src:s.img,alt:"广告"},null,8,We)],8,Ve))),128))])):L("",!0),_.value.length?(u(),r("div",Je,[(u(!0),r(I,null,B(_.value,s=>(u(),r("a",{key:s.id,href:s.url,target:"_blank"},[l("img",{src:s.img,alt:"广告"},null,8,je)],8,Ke))),128))])):L("",!0),ae(Re,{cards:c.value,onClick:e[1]||(e[1]=z(()=>{},["stop"]))},null,8,["cards"]),l("footer",Pe,[l("div",Qe,[l("button",{onClick:e[2]||(e[2]=s=>b.value=!0),class:"friend-link-btn"},e[9]||(e[9]=[l("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),l("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})],-1),oe(" 友情链接 ")])),e[10]||(e[10]=l("p",{class:"copyright"},[oe(" Copyright © 2025 Nav-Item | "),l("a",{href:"https://github.com/LeoJyenn/nav-item",target:"_blank",class:"footer-link"},"Powered by LeoJyenn")],-1))])]),b.value?(u(),r("div",{key:2,class:"modal-overlay",onClick:e[5]||(e[5]=s=>b.value=!1)},[l("div",{class:"modal-content",onClick:e[4]||(e[4]=z(()=>{},["stop"]))},[l("div",Xe,[e[12]||(e[12]=l("h3",null,"友情链接",-1)),l("button",{onClick:e[3]||(e[3]=s=>b.value=!1),class:"close-btn"},e[11]||(e[11]=[l("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),l("div",Ye,[l("div",Ze,[(u(!0),r(I,null,B(k.value,s=>(u(),r("a",{key:s.id,href:s.url,target:"_blank",class:"friend-link-card"},[l("div",tt,[s.logo?(u(),r("img",{key:0,src:s.logo,alt:s.title,onError:ce},null,40,nt)):(u(),r("div",lt,N(s.title.charAt(0)),1))]),l("div",at,[l("h4",null,N(s.title),1)])],8,et))),128))])])])])):L("",!0)],4)}}},ut=K(ot,[["__scopeId","data-v-5f359c5e"]]);export{ut as default};
