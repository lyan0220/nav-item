var le=Object.defineProperty;var J=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var K=(g,i,a)=>i in g?le(g,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):g[i]=a,q=(g,i)=>{for(var a in i||(i={}))ae.call(i,a)&&K(g,a,i[a]);if(J)for(var a of J(i))se.call(i,a)&&K(g,a,i[a]);return g};var E=(g,i,a)=>new Promise((p,u)=>{var f=b=>{try{y(a.next(b))}catch(k){u(k)}},w=b=>{try{y(a.throw(b))}catch(k){u(k)}},y=b=>b.done?p(b.value):Promise.resolve(b.value).then(f,w);y((a=a.apply(g,i)).next())});import{_ as D,r as m,c as r,F as S,a as x,w as G,o as c,b as l,d as A,t as T,n as L,e as P,f as Q,g as H,h as X,i as oe,j as W,k as ie,v as re,l as ce,m as j}from"./index-Dij_Bk4X.js";import{g as ue,a as de,b as ve,c as he,d as ge,e as fe}from"./api-CPdfUet4.js";const me=["onMouseenter","onMouseleave"],pe=["onClick"],be=["onClick"],_e={__name:"MenuBar",props:{menus:Array,activeId:Number,activeSubMenuId:Number},emits:["select"],setup(g,{expose:i,emit:a}){const p=a,u=m(null);function f(h){u.value=h}function w(h){setTimeout(()=>{u.value===h&&(u.value=null)},100)}function y(h){const _=h.subMenus&&h.subMenus.length>0;p("select",h),_&&f(h.id)}function b(h,_){p("select",h,_),u.value=null}function k(){u.value=null}return i({closeAllSubMenus:k}),(h,_)=>(c(),r("nav",{class:"menu-bar",onClick:_[0]||(_[0]=G(()=>{},["stop"]))},[(c(!0),r(S,null,x(g.menus,t=>(c(),r("div",{key:t.id,class:"menu-item",onMouseenter:s=>f(t.id),onMouseleave:s=>w(t.id)},[l("button",{onClick:s=>y(t),class:L({active:t.id===g.activeId})},T(t.name),11,pe),t.subMenus&&t.subMenus.length>0?(c(),r("div",{key:0,class:L(["sub-menu",{show:u.value===t.id}])},[(c(!0),r(S,null,x(t.subMenus,s=>(c(),r("button",{key:s.id,onClick:d=>b(s,t),class:L([{active:s.id===g.activeSubMenuId},"sub-menu-item"])},T(s.name),11,be))),128))],2)):A("",!0)],40,me))),128))]))}},ye=D(_e,[["__scopeId","data-v-ce975f11"]]),ke=["href","title","onClick"],we=["src","onError"],Ce={class:"link-text"},Me={__name:"CardGrid",props:{cards:Array},setup(g){const i=g,a=m(""),p=m("convergeIn"),u=m(null);P(()=>{i.cards&&i.cards.length>0&&f()}),Q(()=>i.cards,(t,s)=>{t&&t.length>0&&(!s||s.length===0||JSON.stringify(t)!==JSON.stringify(s))&&H(()=>{f()})},{deep:!0,immediate:!1});function f(){u.value&&clearTimeout(u.value),a.value="",H(()=>{p.value="convergeIn",a.value=`animate-${p.value}`,u.value=setTimeout(()=>{a.value="",u.value=null},500)})}function w(t){if(!a.value)return{};const d=window.innerWidth<=480||window.innerWidth<=768?3:window.innerWidth<=1200?4:6,B=t%d,I=Math.floor(t/d),M=Math.floor(d/2),R=Math.floor(i.cards.length/d/2),N=Math.abs(B-M),U=Math.abs(I-R);return{animationDelay:`${N*.08+U*.05}s`}}function y(t){window.open(t,"_blank")}function b(t){if(t.custom_logo_path)return"http://localhost:3000/uploads/"+t.custom_logo_path;if(t.logo_url)return t.logo_url;try{return new URL(t.url).origin+"/favicon.ico"}catch(s){return"/default-favicon.png"}}function k(t,s){t.target.src="/default-favicon.png"}function h(t){let s="";return t.desc&&(s+=t.desc+`
`),s+=t.url,s}function _(t){return t?t.length>20?t.slice(0,20)+"...":t:""}return(t,s)=>(c(),r("div",{class:L(["container card-grid",a.value])},[(c(!0),r(S,null,x(g.cards,(d,B)=>(c(),r("div",{key:d.id,class:"link-item",style:X(w(B))},[l("a",{href:d.url,target:"_blank",title:h(d),onClick:G(I=>y(d.url),["prevent"])},[l("img",{class:"link-icon",src:b(d),alt:"",onError:I=>k(I),loading:"lazy"},null,40,we),l("span",Ce,T(_(d.title)),1)],8,ke)],4))),128))],2))}},$e=D(Me,[["__scopeId","data-v-b1c5eb5e"]]),Ie={class:"menu-bar-fixed"},Se={class:"search-section"},xe={class:"search-box-wrapper"},Te={class:"search-engine-select"},Be=["onClick"],Ne={class:"search-container"},Ee=["placeholder"],Ae={key:0,class:"ad-space-fixed left-ad-fixed"},Le=["href"],Ue=["src"],Ge={key:1,class:"ad-space-fixed right-ad-fixed"},Re=["href"],Fe=["src"],Oe={class:"footer"},qe={class:"footer-content"},De={class:"modal-header"},Ve={class:"modal-body"},ze={class:"friend-links-grid"},Je=["href"],Ke={class:"friend-link-logo"},He=["src","alt"],We={key:1,class:"friend-link-placeholder"},je={class:"friend-link-info"},Pe={__name:"Home",setup(g){const i=m([]),a=m(null),p=m(null),u=m([]),f=m(""),w=m([]),y=m([]),b=m(!1),k=m([]),h=m(!1);let _=null;const t=m(null),s=new Map,d=m({bg_url_pc:"",bg_url_mobile:"",bg_opacity:"1",glass_opacity:"1",custom_css:""}),B=oe(()=>{const n=d.value.bg_url_pc,e=d.value.bg_url_mobile,v=parseFloat(d.value.bg_opacity),o=1-(isNaN(v)?.15:v),C={};n&&(C["--dynamic-bg-pc"]=`url(${n})`),e&&(C["--dynamic-bg-mobile"]=`url(${e})`),n||e?C["--dynamic-overlay-color"]=`rgba(0, 0, 0, ${o})`:C["--dynamic-overlay-color"]="rgba(0, 0, 0, 0)";const te=d.value.glass_opacity,V=parseFloat(te),z=isNaN(V)?.7:V;C["--glass-color-rgb"]="255, 255, 255",C["--glass-opacity"]=z;const ne=Math.min(z+.15,1);return C["--glass-opacity-hover"]=ne,C}),I=[{name:"google",label:"Google",placeholder:"Google 搜索...",url:n=>`https://www.google.com/search?q=${encodeURIComponent(n)}`},{name:"baidu",label:"百度",placeholder:"百度搜索...",url:n=>`https://www.baidu.com/s?wd=${encodeURIComponent(n)}`},{name:"bing",label:"Bing",placeholder:"Bing 搜索...",url:n=>`https://www.bing.com/search?q=${encodeURIComponent(n)}`},{name:"github",label:"github",placeholder:"GitHub 搜索...",url:n=>`https://github.com/search?q=${encodeURIComponent(n)}&type=repositories`},{name:"site",label:"站内",placeholder:"站内搜索...",url:n=>`/search?query=${encodeURIComponent(n)}`}],M=m(I[0]);function R(n){M.value=n}function N(){f.value="",h.value&&(h.value=!1,i.value.length?U(i.value[0]):u.value=[])}P(()=>E(null,null,function*(){ue().then(n=>{d.value=q(q({},d.value),n.data)}).catch(n=>{console.error("加载网站设置失败:",n)}),de().then(n=>{i.value=n.data,i.value.length&&(a.value=i.value[0],F())}),ve().then(n=>{w.value=n.data.filter(e=>e.position==="left"),y.value=n.data.filter(e=>e.position==="right")}),he().then(n=>{k.value=n.data})})),Q(()=>d.value.custom_css,n=>{const e="custom-nav-style";let v=document.getElementById(e);v||(v=document.createElement("style"),v.id=e,document.head.appendChild(v)),v.textContent=n||""},{immediate:!0});function U(n,e=null){return E(this,null,function*(){f.value="",h.value=!1,e?(a.value=e,p.value=n):(a.value=n,p.value=null),F()})}function F(){return E(this,null,function*(){var e;if(!a.value)return;const n=p.value?`submenu-${p.value.id}`:`menu-${a.value.id}`;if(s.has(n)){u.value=s.get(n);return}try{const v=yield ge(a.value.id,(e=p.value)==null?void 0:e.id);u.value=v.data,s.set(n,v.data)}catch(v){console.error("加载卡片失败:",v),u.value=[]}})}function Y(){clearTimeout(_),M.value.name==="site"&&(_=setTimeout(()=>{f.value.trim()===""?N():O(!0)},300))}function O(n=!1){return E(this,null,function*(){if(clearTimeout(_),M.value.name==="site"){const e=f.value.trim();if(!e){N();return}const v=`search-${e}`;if(s.has(v)){u.value=s.get(v),h.value=!0,a.value=null,p.value=null;return}try{const $=yield fe(e);u.value=$.data,s.set(v,$.data),h.value=!0,a.value=null,p.value=null}catch($){console.error("全局搜索失败:",$),n||alert("搜索失败，请稍后重试。")}}else{if(!f.value.trim())return;const e=M.value.url(f.value);window.open(e,"_blank")}})}function Z(){t.value&&t.value.closeAllSubMenus()}function ee(n){n.target.style.display="none",n.target.nextElementSibling.style.display="flex"}return(n,e)=>{var v,$;return c(),r("div",{class:"home-container",style:X(B.value),onClick:Z},[l("div",Ie,[W(ye,{ref:t.value,menus:i.value,activeId:(v=a.value)==null?void 0:v.id,activeSubMenuId:($=p.value)==null?void 0:$.id,onSelect:U},null,8,["menus","activeId","activeSubMenuId"])]),l("div",Se,[l("div",xe,[l("div",Te,[(c(),r(S,null,x(I,o=>l("button",{key:o.name,class:L(["engine-btn",{active:M.value.name===o.name}]),onClick:C=>R(o)},T(o.label),11,Be)),64)),e[6]||(e[6]=l("a",{href:"/admin",target:"_blank",class:"engine-btn admin-btn"}," 后台 ",-1))]),l("div",Ne,[ie(l("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>f.value=o),type:"text",placeholder:M.value.placeholder,class:"search-input",onKeyup:ce(O,["enter"]),onInput:Y},null,40,Ee),[[re,f.value]]),f.value?(c(),r("button",{key:0,class:"clear-btn",onClick:N,"aria-label":"清空",title:"clear"},e[7]||(e[7]=[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"2"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))):A("",!0),l("button",{onClick:O,class:"search-btn",title:"search"},e[8]||(e[8]=[l("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},[l("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))])])]),w.value.length?(c(),r("div",Ae,[(c(!0),r(S,null,x(w.value,o=>(c(),r("a",{key:o.id,href:o.url,target:"_blank"},[l("img",{src:o.img,alt:"广告"},null,8,Ue)],8,Le))),128))])):A("",!0),y.value.length?(c(),r("div",Ge,[(c(!0),r(S,null,x(y.value,o=>(c(),r("a",{key:o.id,href:o.url,target:"_blank"},[l("img",{src:o.img,alt:"广告"},null,8,Fe)],8,Re))),128))])):A("",!0),W($e,{cards:u.value,onClick:e[1]||(e[1]=G(()=>{},["stop"]))},null,8,["cards"]),l("footer",Oe,[l("div",qe,[l("button",{onClick:e[2]||(e[2]=o=>b.value=!0),class:"friend-link-btn"},e[9]||(e[9]=[l("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),l("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})],-1),j(" 友情链接 ")])),e[10]||(e[10]=l("p",{class:"copyright"},[j(" Copyright © 2025 Nav-Item | "),l("a",{href:"https://github.com/LeoJyenn/nav-item",target:"_blank",class:"footer-link"},"Powered by LeoJyenn")],-1))])]),b.value?(c(),r("div",{key:2,class:"modal-overlay",onClick:e[5]||(e[5]=o=>b.value=!1)},[l("div",{class:"modal-content",onClick:e[4]||(e[4]=G(()=>{},["stop"]))},[l("div",De,[e[12]||(e[12]=l("h3",null,"友情链接",-1)),l("button",{onClick:e[3]||(e[3]=o=>b.value=!1),class:"close-btn"},e[11]||(e[11]=[l("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),l("div",Ve,[l("div",ze,[(c(!0),r(S,null,x(k.value,o=>(c(),r("a",{key:o.id,href:o.url,target:"_blank",class:"friend-link-card"},[l("div",Ke,[o.logo?(c(),r("img",{key:0,src:o.logo,alt:o.title,onError:ee},null,40,He)):(c(),r("div",We,T(o.title.charAt(0)),1))]),l("div",je,[l("h4",null,T(o.title),1)])],8,Je))),128))])])])])):A("",!0)],4)}}},Ze=D(Pe,[["__scopeId","data-v-1a316a19"]]);export{Ze as default};
