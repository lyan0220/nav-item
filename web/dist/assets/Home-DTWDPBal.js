var ce=Object.defineProperty;var Y=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var Z=(g,o,a)=>o in g?ce(g,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):g[o]=a,H=(g,o)=>{for(var a in o||(o={}))de.call(o,a)&&Z(g,a,o[a]);if(Y)for(var a of Y(o))ve.call(o,a)&&Z(g,a,o[a]);return g};var E=(g,o,a)=>new Promise((p,c)=>{var m=b=>{try{_(a.next(b))}catch(k){c(k)}},w=b=>{try{_(a.throw(b))}catch(k){c(k)}},_=b=>b.done?p(b.value):Promise.resolve(b.value).then(m,w);_((a=a.apply(g,o)).next())});import{_ as J,r as h,c as r,F as B,a as T,w as R,o as u,b as l,d as L,t as N,n as A,e as le,f as V,g as G,h as W,i as ee,j as he,k as te,l as fe,v as ge,m as me,p as ne}from"./index-DFWsRajp.js";import{g as pe,a as be,b as ye,c as _e,d as ke,e as we}from"./api-CPdfUet4.js";const Ce=["onMouseenter","onMouseleave"],Me=["onClick"],$e=["onClick"],xe={__name:"MenuBar",props:{menus:Array,activeId:Number,activeSubMenuId:Number},emits:["select"],setup(g,{expose:o,emit:a}){const p=a,c=h(null);function m(f){c.value=f}function w(f){setTimeout(()=>{c.value===f&&(c.value=null)},100)}function _(f){const y=f.subMenus&&f.subMenus.length>0;p("select",f),y&&m(f.id)}function b(f,y){p("select",f,y),c.value=null}function k(){c.value=null}return o({closeAllSubMenus:k}),(f,y)=>(u(),r("nav",{class:"menu-bar",onClick:y[0]||(y[0]=R(()=>{},["stop"]))},[(u(!0),r(B,null,T(g.menus,t=>(u(),r("div",{key:t.id,class:"menu-item",onMouseenter:i=>m(t.id),onMouseleave:i=>w(t.id)},[l("button",{onClick:i=>_(t),class:A({active:t.id===g.activeId})},N(t.name),11,Me),t.subMenus&&t.subMenus.length>0?(u(),r("div",{key:0,class:A(["sub-menu",{show:c.value===t.id}])},[(u(!0),r(B,null,T(t.subMenus,i=>(u(),r("button",{key:i.id,onClick:d=>b(i,t),class:A([{active:i.id===g.activeSubMenuId},"sub-menu-item"])},N(i.name),11,$e))),128))],2)):L("",!0)],40,Ce))),128))]))}},Se=J(xe,[["__scopeId","data-v-ce975f11"]]),Ie=["href","title","onClick"],Be=["src","onError"],Te={class:"link-text"},Ee={__name:"CardGrid",props:{cards:Array},setup(g){const o=g,a=h(""),p=h("convergeIn"),c=h(null);le(()=>{o.cards&&o.cards.length>0&&m()}),V(()=>o.cards,(t,i)=>{t&&t.length>0&&(!i||i.length===0||JSON.stringify(t)!==JSON.stringify(i))&&G(()=>{m()})},{deep:!0,immediate:!1});function m(){c.value&&clearTimeout(c.value),a.value="",G(()=>{p.value="convergeIn",a.value=`animate-${p.value}`,c.value=setTimeout(()=>{a.value="",c.value=null},500)})}function w(t){if(!a.value)return{};const d=window.innerWidth<=480||window.innerWidth<=768?3:window.innerWidth<=1200?4:6,x=t%d,C=Math.floor(t/d),M=Math.floor(d/2),z=Math.floor(o.cards.length/d/2),F=Math.abs(x-M),U=Math.abs(C-z);return{animationDelay:`${F*.08+U*.05}s`}}function _(t){window.open(t,"_blank")}function b(t){if(t.custom_logo_path)return"http://localhost:3000/uploads/"+t.custom_logo_path;if(t.logo_url)return t.logo_url;try{return new URL(t.url).origin+"/favicon.ico"}catch(i){return"/default-favicon.png"}}function k(t,i){t.target.src="/default-favicon.png"}function f(t){let i="";return t.desc&&(i+=t.desc+`
`),i+=t.url,i}function y(t){return t?t.length>20?t.slice(0,20)+"...":t:""}return(t,i)=>(u(),r("div",{class:A(["container card-grid",a.value])},[(u(!0),r(B,null,T(g.cards,(d,x)=>(u(),r("div",{key:d.id,class:"link-item",style:W(w(x))},[l("a",{href:d.url,target:"_blank",title:f(d),onClick:R(C=>_(d.url),["prevent"])},[l("img",{class:"link-icon",src:b(d),alt:"",onError:C=>k(C),loading:"lazy"},null,40,Be),l("span",Te,N(y(d.title)),1)],8,Ie)],4))),128))],2))}},Ne=J(Ee,[["__scopeId","data-v-b1c5eb5e"]]),Le={class:"search-box-wrapper"},Ae={class:"search-engine-select"},Ge=["onClick"],Ue={class:"search-container"},Re=["placeholder"],ze={key:0,class:"ad-space-fixed left-ad-fixed"},Fe=["href"],Oe=["src"],qe={key:1,class:"ad-space-fixed right-ad-fixed"},De=["href"],He=["src"],Ve={class:"footer"},We={class:"footer-content"},Je={class:"modal-header"},Ke={class:"modal-body"},je={class:"friend-links-grid"},Pe=["href"],Qe={class:"friend-link-logo"},Xe=["src","alt"],Ye={key:1,class:"friend-link-placeholder"},Ze={class:"friend-link-info"},et={__name:"Home",setup(g){const o=h([]),a=h(null),p=h(null),c=h([]),m=h(""),w=h([]),_=h([]),b=h(!1),k=h([]),f=h(!1);let y=null;const t=h(null),i=h(null),d=new Map,x=h(!1),C=h(0),M=h({bg_url_pc:"",bg_url_mobile:"",bg_opacity:"1",glass_opacity:"1",custom_css:""}),z=ee(()=>{const n=M.value.bg_url_pc,e=M.value.bg_url_mobile,v=parseFloat(M.value.bg_opacity),s=1-(isNaN(v)?.15:v),$={};n&&($["--dynamic-bg-pc"]=`url(${n})`),e&&($["--dynamic-bg-mobile"]=`url(${e})`),n||e?$["--dynamic-overlay-color"]=`rgba(0, 0, 0, ${s})`:$["--dynamic-overlay-color"]="rgba(0, 0, 0, 0)";const re=M.value.glass_opacity,Q=parseFloat(re),X=isNaN(Q)?.7:Q;$["--glass-color-rgb"]="255, 255, 255",$["--glass-opacity"]=X;const ue=Math.min(X+.15,1);return $["--glass-opacity-hover"]=ue,$}),F=ee(()=>x.value?{marginTop:C.value>0?`${C.value+13}px`:"70px"}:{}),U=[{name:"google",label:"Google",placeholder:"Google 搜索...",url:n=>`https://www.google.com/search?q=${encodeURIComponent(n)}`},{name:"baidu",label:"百度",placeholder:"百度搜索...",url:n=>`https://www.baidu.com/s?wd=${encodeURIComponent(n)}`},{name:"bing",label:"Bing",placeholder:"Bing 搜索...",url:n=>`https://www.bing.com/search?q=${encodeURIComponent(n)}`},{name:"github",label:"github",placeholder:"GitHub 搜索...",url:n=>`https://github.com/search?q=${encodeURIComponent(n)}&type=repositories`},{name:"site",label:"站内",placeholder:"站内搜索...",url:n=>`/search?query=${encodeURIComponent(n)}`}],I=h(U[0]);function ae(n){I.value=n}function O(){m.value="",f.value&&(f.value=!1,o.value.length?j(o.value[0]):c.value=[])}function q(){if(!x.value){C.value=0;return}i.value&&(C.value=i.value.offsetHeight||0)}const K=()=>{x.value=window.innerWidth<=768,G(()=>{q()})};le(()=>E(null,null,function*(){x.value=window.innerWidth<=768,window.addEventListener("resize",K),pe().then(n=>{M.value=H(H({},M.value),n.data)}).catch(n=>{console.error("加载网站设置失败:",n)}),be().then(n=>E(null,null,function*(){o.value=n.data,yield G(),q(),o.value.length&&(a.value=o.value[0],P())})),ye().then(n=>{w.value=n.data.filter(e=>e.position==="left"),_.value=n.data.filter(e=>e.position==="right")}),_e().then(n=>{k.value=n.data})})),he(()=>{window.removeEventListener("resize",K)}),V(()=>o.value,()=>{G(()=>{q()})},{deep:!0}),V(()=>M.value.custom_css,n=>{const e="custom-nav-style";let v=document.getElementById(e);v||(v=document.createElement("style"),v.id=e,document.head.appendChild(v)),v.textContent=n||""},{immediate:!0});function j(n,e=null){return E(this,null,function*(){m.value="",f.value=!1,e?(a.value=e,p.value=n):(a.value=n,p.value=null),P()})}function P(){return E(this,null,function*(){var e;if(!a.value)return;const n=p.value?`submenu-${p.value.id}`:`menu-${a.value.id}`;if(d.has(n)){c.value=d.get(n);return}try{const v=yield ke(a.value.id,(e=p.value)==null?void 0:e.id);c.value=v.data,d.set(n,v.data)}catch(v){console.error("加载卡片失败:",v),c.value=[]}})}function oe(){clearTimeout(y),I.value.name==="site"&&(y=setTimeout(()=>{m.value.trim()===""?O():D(!0)},300))}function D(n=!1){return E(this,null,function*(){if(clearTimeout(y),I.value.name==="site"){const e=m.value.trim();if(!e){O();return}const v=`search-${e}`;if(d.has(v)){c.value=d.get(v),f.value=!0,a.value=null,p.value=null;return}try{const S=yield we(e);c.value=S.data,d.set(v,S.data),f.value=!0,a.value=null,p.value=null}catch(S){console.error("全局搜索失败:",S),n||alert("搜索失败，请稍后重试。")}}else{if(!m.value.trim())return;const e=I.value.url(m.value);window.open(e,"_blank")}})}function se(){t.value&&t.value.closeAllSubMenus()}function ie(n){n.target.style.display="none",n.target.nextElementSibling.style.display="flex"}return(n,e)=>{var v,S;return u(),r("div",{class:"home-container",style:W(z.value),onClick:se},[l("div",{class:"menu-bar-fixed",ref_key:"menuBarContainer",ref:i},[te(Se,{ref:t.value,menus:o.value,activeId:(v=a.value)==null?void 0:v.id,activeSubMenuId:(S=p.value)==null?void 0:S.id,onSelect:j},null,8,["menus","activeId","activeSubMenuId"])],512),l("div",{class:"search-section",style:W(F.value)},[l("div",Le,[l("div",Ae,[(u(),r(B,null,T(U,s=>l("button",{key:s.name,class:A(["engine-btn",{active:I.value.name===s.name}]),onClick:$=>ae(s)},N(s.label),11,Ge)),64)),e[6]||(e[6]=l("a",{href:"/admin",target:"_blank",class:"engine-btn admin-btn"}," 后台 ",-1))]),l("div",Ue,[fe(l("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>m.value=s),type:"text",placeholder:I.value.placeholder,class:"search-input",onKeyup:me(D,["enter"]),onInput:oe},null,40,Re),[[ge,m.value]]),m.value?(u(),r("button",{key:0,class:"clear-btn",onClick:O,"aria-label":"清空",title:"clear"},e[7]||(e[7]=[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"2"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))):L("",!0),l("button",{onClick:D,class:"search-btn",title:"search"},e[8]||(e[8]=[l("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},[l("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))])])],4),w.value.length?(u(),r("div",ze,[(u(!0),r(B,null,T(w.value,s=>(u(),r("a",{key:s.id,href:s.url,target:"_blank"},[l("img",{src:s.img,alt:"广告"},null,8,Oe)],8,Fe))),128))])):L("",!0),_.value.length?(u(),r("div",qe,[(u(!0),r(B,null,T(_.value,s=>(u(),r("a",{key:s.id,href:s.url,target:"_blank"},[l("img",{src:s.img,alt:"广告"},null,8,He)],8,De))),128))])):L("",!0),te(Ne,{cards:c.value,onClick:e[1]||(e[1]=R(()=>{},["stop"]))},null,8,["cards"]),l("footer",Ve,[l("div",We,[l("button",{onClick:e[2]||(e[2]=s=>b.value=!0),class:"friend-link-btn"},e[9]||(e[9]=[l("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),l("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})],-1),ne(" 友情链接 ")])),e[10]||(e[10]=l("p",{class:"copyright"},[ne(" Copyright © 2025 Nav-Item | "),l("a",{href:"https://github.com/LeoJyenn/nav-item",target:"_blank",class:"footer-link"},"Powered by LeoJyenn")],-1))])]),b.value?(u(),r("div",{key:2,class:"modal-overlay",onClick:e[5]||(e[5]=s=>b.value=!1)},[l("div",{class:"modal-content",onClick:e[4]||(e[4]=R(()=>{},["stop"]))},[l("div",Je,[e[12]||(e[12]=l("h3",null,"友情链接",-1)),l("button",{onClick:e[3]||(e[3]=s=>b.value=!1),class:"close-btn"},e[11]||(e[11]=[l("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),l("div",Ke,[l("div",je,[(u(!0),r(B,null,T(k.value,s=>(u(),r("a",{key:s.id,href:s.url,target:"_blank",class:"friend-link-card"},[l("div",Qe,[s.logo?(u(),r("img",{key:0,src:s.logo,alt:s.title,onError:ie},null,40,Xe)):(u(),r("div",Ye,N(s.title.charAt(0)),1))]),l("div",Ze,[l("h4",null,N(s.title),1)])],8,Pe))),128))])])])])):L("",!0)],4)}}},at=J(et,[["__scopeId","data-v-7a805fe8"]]);export{at as default};
