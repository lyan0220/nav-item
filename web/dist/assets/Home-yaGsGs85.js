var ge=Object.defineProperty,me=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var be=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable;var ne=(f,o,a)=>o in f?ge(f,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):f[o]=a,R=(f,o)=>{for(var a in o||(o={}))be.call(o,a)&&ne(f,a,o[a]);if(te)for(var a of te(o))ye.call(o,a)&&ne(f,a,o[a]);return f},le=(f,o)=>me(f,pe(o));var E=(f,o,a)=>new Promise((p,c)=>{var m=b=>{try{k(a.next(b))}catch(w){c(w)}},C=b=>{try{k(a.throw(b))}catch(w){c(w)}},k=b=>b.done?p(b.value):Promise.resolve(b.value).then(m,C);k((a=a.apply(f,o)).next())});import{_ as K,r as h,c as r,F as I,a as B,w as F,o as u,b as l,d as G,t as L,n as A,e as se,f as W,g as U,h as J,i as N,j as _e,k as ae,l as ke,v as we,m as Ce,p as oe}from"./index-CkimXjrj.js";import{g as Me,a as xe,b as $e,c as Se,d as Ie,e as Be}from"./api-CPdfUet4.js";const Te=["onMouseenter","onMouseleave"],Ee=["onClick"],Ne=["onClick"],Le={__name:"MenuBar",props:{menus:Array,activeId:Number,activeSubMenuId:Number},emits:["select"],setup(f,{expose:o,emit:a}){const p=a,c=h(null);function m(g){c.value=g}function C(g){setTimeout(()=>{c.value===g&&(c.value=null)},100)}function k(g){const _=g.subMenus&&g.subMenus.length>0;p("select",g),_&&m(g.id)}function b(g,_){p("select",g,_),c.value=null}function w(){c.value=null}return o({closeAllSubMenus:w}),(g,_)=>(u(),r("nav",{class:"menu-bar",onClick:_[0]||(_[0]=F(()=>{},["stop"]))},[(u(!0),r(I,null,B(f.menus,n=>(u(),r("div",{key:n.id,class:"menu-item",onMouseenter:i=>m(n.id),onMouseleave:i=>C(n.id)},[l("button",{onClick:i=>k(n),class:A({active:n.id===f.activeId})},L(n.name),11,Ee),n.subMenus&&n.subMenus.length>0?(u(),r("div",{key:0,class:A(["sub-menu",{show:c.value===n.id}])},[(u(!0),r(I,null,B(n.subMenus,i=>(u(),r("button",{key:i.id,onClick:d=>b(i,n),class:A([{active:i.id===f.activeSubMenuId},"sub-menu-item"])},L(i.name),11,Ne))),128))],2)):G("",!0)],40,Te))),128))]))}},Ae=K(Le,[["__scopeId","data-v-ce975f11"]]),Ge=["href","title","onClick"],Ue=["src","onError"],Re={class:"link-text"},Fe={__name:"CardGrid",props:{cards:Array},setup(f){const o=f,a=h(""),p=h("convergeIn"),c=h(null);se(()=>{o.cards&&o.cards.length>0&&m()}),W(()=>o.cards,(n,i)=>{n&&n.length>0&&(!i||i.length===0||JSON.stringify(n)!==JSON.stringify(i))&&U(()=>{m()})},{deep:!0,immediate:!1});function m(){c.value&&clearTimeout(c.value),a.value="",U(()=>{p.value="convergeIn",a.value=`animate-${p.value}`,c.value=setTimeout(()=>{a.value="",c.value=null},500)})}function C(n){if(!a.value)return{};const d=window.innerWidth<=480||window.innerWidth<=768?3:window.innerWidth<=1200?4:6,$=n%d,M=Math.floor(n/d),y=Math.floor(d/2),z=Math.floor(o.cards.length/d/2),O=Math.abs($-y),D=Math.abs(M-z);return{animationDelay:`${O*.08+D*.05}s`}}function k(n){window.open(n,"_blank")}function b(n){if(n.custom_logo_path)return"http://localhost:3000/uploads/"+n.custom_logo_path;if(n.logo_url)return n.logo_url;try{return new URL(n.url).origin+"/favicon.ico"}catch(i){return"/default-favicon.png"}}function w(n,i){n.target.src="/default-favicon.png"}function g(n){let i="";return n.desc&&(i+=n.desc+`
`),i+=n.url,i}function _(n){return n?n.length>20?n.slice(0,20)+"...":n:""}return(n,i)=>(u(),r("div",{class:A(["container card-grid",a.value])},[(u(!0),r(I,null,B(f.cards,(d,$)=>(u(),r("div",{key:d.id,class:"link-item",style:J(C($))},[l("a",{href:d.url,target:"_blank",title:g(d),onClick:F(M=>k(d.url),["prevent"])},[l("img",{class:"link-icon",src:b(d),alt:"",onError:M=>w(M),loading:"lazy"},null,40,Ue),l("span",Re,L(_(d.title)),1)],8,Ge)],4))),128))],2))}},ze=K(Fe,[["__scopeId","data-v-b1c5eb5e"]]),Oe={class:"search-box-wrapper"},De={class:"search-engine-select"},qe=["onClick"],He={class:"search-container"},Ve=["placeholder"],We={key:0,class:"ad-space-fixed left-ad-fixed"},Je=["href"],Ke=["src"],je={key:1,class:"ad-space-fixed right-ad-fixed"},Pe=["href"],Qe=["src"],Xe={class:"footer"},Ye={class:"footer-content"},Ze={class:"modal-header"},et={class:"modal-body"},tt={class:"friend-links-grid"},nt=["href"],lt={class:"friend-link-logo"},at=["src","alt"],ot={key:1,class:"friend-link-placeholder"},st={class:"friend-link-info"},it={__name:"Home",setup(f){const o=h([]),a=h(null),p=h(null),c=h([]),m=h(""),C=h([]),k=h([]),b=h(!1),w=h([]),g=h(!1);let _=null;const n=h(null),i=h(null),d=new Map,$=h(!1),M=h(0),y=h({bg_url_pc:"",bg_url_mobile:"",bg_opacity:"1",glass_opacity:"1",custom_css:"",text_color_mode:"auto"}),z=N(()=>{const t=y.value.bg_url_pc,e=y.value.bg_url_mobile,v=parseFloat(y.value.bg_opacity),s=1-(isNaN(v)?.15:v),x={};t&&(x["--dynamic-bg-pc"]=`url(${t})`),e&&(x["--dynamic-bg-mobile"]=`url(${e})`),t||e?x["--dynamic-overlay-color"]=`rgba(0, 0, 0, ${s})`:x["--dynamic-overlay-color"]="rgba(0, 0, 0, 0)";const he=y.value.glass_opacity,Z=parseFloat(he),ee=isNaN(Z)?.7:Z;x["--glass-color-rgb"]="255, 255, 255",x["--glass-opacity"]=ee;const fe=Math.min(ee+.15,1);return x["--glass-opacity-hover"]=fe,x}),O=N(()=>{const t=y.value.text_color_mode||"auto",e=parseFloat(y.value.bg_opacity||"1");return t==="black"?"#000000":t==="white"||e<=.5?"#ffffff":"#000000"}),D=N(()=>parseFloat(y.value.bg_opacity||"1")<=.5),j=N(()=>le(R({},z.value),{"--global-text-color":O.value})),ie=N(()=>{const t=y.value.text_color_mode||"auto";return t==="white"?"text-mode-white":t==="black"?"text-mode-black":"text-mode-auto"}),re=N(()=>$.value?{marginTop:M.value>0?`${M.value+13}px`:"70px"}:{}),P=[{name:"google",label:"Google",placeholder:"Google 搜索...",url:t=>`https://www.google.com/search?q=${encodeURIComponent(t)}`},{name:"baidu",label:"百度",placeholder:"百度搜索...",url:t=>`https://www.baidu.com/s?wd=${encodeURIComponent(t)}`},{name:"bing",label:"Bing",placeholder:"Bing 搜索...",url:t=>`https://www.bing.com/search?q=${encodeURIComponent(t)}`},{name:"github",label:"github",placeholder:"GitHub 搜索...",url:t=>`https://github.com/search?q=${encodeURIComponent(t)}&type=repositories`},{name:"site",label:"站内",placeholder:"站内搜索...",url:t=>`/search?query=${encodeURIComponent(t)}`}],T=h(P[0]);function ue(t){T.value=t}function q(){m.value="",g.value&&(g.value=!1,o.value.length?X(o.value[0]):c.value=[])}function H(){if(!$.value){M.value=0;return}i.value&&(M.value=i.value.offsetHeight||0)}const Q=()=>{$.value=window.innerWidth<=768,U(()=>{H()})};se(()=>E(null,null,function*(){$.value=window.innerWidth<=768,window.addEventListener("resize",Q),Me().then(t=>{y.value=R(R({},y.value),t.data)}).catch(t=>{console.error("加载网站设置失败:",t)}),xe().then(t=>E(null,null,function*(){o.value=t.data,yield U(),H(),o.value.length&&(a.value=o.value[0],Y())})),$e().then(t=>{C.value=t.data.filter(e=>e.position==="left"),k.value=t.data.filter(e=>e.position==="right")}),Se().then(t=>{w.value=t.data})})),_e(()=>{window.removeEventListener("resize",Q)}),W(()=>o.value,()=>{U(()=>{H()})},{deep:!0}),W(()=>y.value.custom_css,t=>{const e="custom-nav-style";let v=document.getElementById(e);v||(v=document.createElement("style"),v.id=e,document.head.appendChild(v)),v.textContent=t||""},{immediate:!0});function X(t,e=null){return E(this,null,function*(){m.value="",g.value=!1,e?(a.value=e,p.value=t):(a.value=t,p.value=null),Y()})}function Y(){return E(this,null,function*(){var e;if(!a.value)return;const t=p.value?`submenu-${p.value.id}`:`menu-${a.value.id}`;if(d.has(t)){c.value=d.get(t);return}try{const v=yield Ie(a.value.id,(e=p.value)==null?void 0:e.id);c.value=v.data,d.set(t,v.data)}catch(v){console.error("加载卡片失败:",v),c.value=[]}})}function ce(){clearTimeout(_),T.value.name==="site"&&(_=setTimeout(()=>{m.value.trim()===""?q():V(!0)},300))}function V(t=!1){return E(this,null,function*(){if(clearTimeout(_),T.value.name==="site"){const e=m.value.trim();if(!e){q();return}const v=`search-${e}`;if(d.has(v)){c.value=d.get(v),g.value=!0,a.value=null,p.value=null;return}try{const S=yield Be(e);c.value=S.data,d.set(v,S.data),g.value=!0,a.value=null,p.value=null}catch(S){console.error("全局搜索失败:",S),t||alert("搜索失败，请稍后重试。")}}else{if(!m.value.trim())return;const e=T.value.url(m.value);window.open(e,"_blank")}})}function de(){n.value&&n.value.closeAllSubMenus()}function ve(t){t.target.style.display="none",t.target.nextElementSibling.style.display="flex"}return(t,e)=>{var v,S;return u(),r("div",{class:A(["home-container",ie.value,{"is-dark-overlay":D.value}]),style:J(j.value),onClick:de},[l("div",{class:"menu-bar-fixed",ref_key:"menuBarContainer",ref:i},[ae(Ae,{ref:n.value,menus:o.value,activeId:(v=a.value)==null?void 0:v.id,activeSubMenuId:(S=p.value)==null?void 0:S.id,onSelect:X},null,8,["menus","activeId","activeSubMenuId"])],512),l("div",{class:"search-section",style:J(re.value)},[l("div",Oe,[l("div",De,[(u(),r(I,null,B(P,s=>l("button",{key:s.name,class:A(["engine-btn",{active:T.value.name===s.name}]),onClick:x=>ue(s)},L(s.label),11,qe)),64)),e[6]||(e[6]=l("a",{href:"/admin",class:"engine-btn admin-btn"}," 后台 ",-1))]),l("div",He,[ke(l("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>m.value=s),type:"text",placeholder:T.value.placeholder,class:"search-input",onKeyup:Ce(V,["enter"]),onInput:ce},null,40,Ve),[[we,m.value]]),m.value?(u(),r("button",{key:0,class:"clear-btn",onClick:q,"aria-label":"清空",title:"clear"},e[7]||(e[7]=[l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"2"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))):G("",!0),l("button",{onClick:V,class:"search-btn",title:"search"},e[8]||(e[8]=[l("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none"},[l("path",{d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))])])],4),C.value.length?(u(),r("div",We,[(u(!0),r(I,null,B(C.value,s=>(u(),r("a",{key:s.id,href:s.url,target:"_blank"},[l("img",{src:s.img,alt:"广告"},null,8,Ke)],8,Je))),128))])):G("",!0),k.value.length?(u(),r("div",je,[(u(!0),r(I,null,B(k.value,s=>(u(),r("a",{key:s.id,href:s.url,target:"_blank"},[l("img",{src:s.img,alt:"广告"},null,8,Qe)],8,Pe))),128))])):G("",!0),ae(ze,{cards:c.value,onClick:e[1]||(e[1]=F(()=>{},["stop"]))},null,8,["cards"]),l("footer",Xe,[l("div",Ye,[l("button",{onClick:e[2]||(e[2]=s=>b.value=!0),class:"friend-link-btn"},e[9]||(e[9]=[l("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),l("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})],-1),oe(" 友情链接 ")])),e[10]||(e[10]=l("p",{class:"copyright"},[oe(" Copyright © 2025 Nav-Item | "),l("a",{href:"https://github.com/LeoJyenn/nav-item",target:"_blank",class:"footer-link"},"Powered by LeoJyenn")],-1))])]),b.value?(u(),r("div",{key:2,class:"modal-overlay",onClick:e[5]||(e[5]=s=>b.value=!1)},[l("div",{class:"modal-content",onClick:e[4]||(e[4]=F(()=>{},["stop"]))},[l("div",Ze,[e[12]||(e[12]=l("h3",null,"友情链接",-1)),l("button",{onClick:e[3]||(e[3]=s=>b.value=!1),class:"close-btn"},e[11]||(e[11]=[l("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M18 6L6 18M6 6l12 12"})],-1)]))]),l("div",et,[l("div",tt,[(u(!0),r(I,null,B(w.value,s=>(u(),r("a",{key:s.id,href:s.url,target:"_blank",class:"friend-link-card"},[l("div",lt,[s.logo?(u(),r("img",{key:0,src:s.logo,alt:s.title,onError:ve},null,40,at)):(u(),r("div",ot,L(s.title.charAt(0)),1))]),l("div",st,[l("h4",null,L(s.title),1)])],8,nt))),128))])])])])):G("",!0)],6)}}},dt=K(it,[["__scopeId","data-v-abbdd05c"]]);export{dt as default};
